---
globs: "*.ts,*.tsx"
description: "TypeScript 파일 작성 시 적용되는 규칙"
---

# TypeScript 작성 규칙

## 타입 정의 원칙

### 인터페이스 vs 타입

- **인터페이스**: 객체 구조 정의, 확장 가능한 경우
- **타입**: 유니온, 인터섹션, 원시 타입 별칭

```typescript
// ✅ 인터페이스 사용
interface IUser {
  id: string
  name: string
}

// 확장 가능
interface IAdmin extends IUser {
  role: 'admin'
}

// ✅ 타입 사용
type MBTIType = 'INTJ' | 'INTP' | 'ENTJ' | 'ENTP'  // 유니온
type UserWithRole = IUser & { role: string }         // 인터섹션
```

### 명시적 타입 정의

모든 함수, 변수에 명확한 타입을 정의합니다.

```typescript
// ✅ 좋은 예시
const calculatePercentage = (current: number, total: number): number => {
  return Math.round((current / total) * 100)
}

const user: IUser = {
  id: '123',
  name: 'John'
}

// ❌ 나쁜 예시
const calculatePercentage = (current, total) => {  // 타입 누락
  return Math.round((current / total) * 100)
}

const user = { id: '123', name: 'John' }  // 타입 추론에만 의존
```

## Generic 타입 활용

재사용 가능한 타입-안전 코드를 작성합니다.

```typescript
// ✅ Generic 활용
interface IApiResponse<T> {
  data: T
  status: number
  message: string
}

function fetchData<T>(url: string): Promise<IApiResponse<T>> {
  return fetch(url).then(res => res.json())
}

// 사용
const response = await fetchData<IUser>('/api/user')
// response.data는 IUser 타입으로 추론됨
```

## 타입 가드 사용

런타임 타입 체크를 위한 타입 가드를 활용합니다.

```typescript
// ✅ 타입 가드 함수
function isQuestion(obj: unknown): obj is IQuestion {
  return (
    typeof obj === 'object' &&
    obj !== null &&
    'id' in obj &&
    'question' in obj &&
    'options' in obj
  )
}

// 사용
if (isQuestion(data)) {
  // data는 IQuestion 타입으로 좁혀짐
  console.log(data.question)
}
```

## null/undefined 처리

옵셔널 체이닝과 nullish coalescing을 활용합니다.

```typescript
// ✅ 안전한 접근
const userName = user?.profile?.name ?? 'Anonymous'
const answers = quizState.answers?.length ?? 0

// ❌ 위험한 접근
const userName = user.profile.name || 'Anonymous'  // falsy 값도 대체됨
```

## 유틸리티 타입 활용

TypeScript 내장 유틸리티 타입을 적극 활용합니다.

```typescript
// Partial - 모든 속성을 optional로
type PartialUser = Partial<IUser>

// Required - 모든 속성을 required로
type RequiredConfig = Required<IConfig>

// Pick - 특정 속성만 선택
type UserPreview = Pick<IUser, 'id' | 'name'>

// Omit - 특정 속성 제외
type UserWithoutPassword = Omit<IUser, 'password'>

// Record - 키-값 쌍 타입
type CategoryScores = Record<QuestionCategory, number>
```

## 타입 참조

프로젝트의 모든 타입은 [src/types/index.ts](mdc:src/types/index.ts)에 정의되어 있습니다.

### 주요 타입

- `MBTIType`: 16가지 MBTI 유형
- `IQuestion`: 퀴즈 질문 구조
- `IAnswer`: 사용자 답변 구조
- `IQuizState`: 퀴즈 진행 상태
- `IQuizResult`: 퀴즈 결과
- `IPlaystyleProfile`: 플레이스타일 프로필

## 주석 작성

복잡한 타입이나 비즈니스 로직에는 한국어 주석을 추가합니다.

```typescript
/**
 * MBTI 점수를 계산하여 최종 유형을 결정합니다.
 * 
 * @param answers - 사용자의 모든 답변
 * @param questions - 질문 데이터셋
 * @returns 계산된 MBTI 유형 및 각 차원별 점수
 */
function calculateMBTI(
  answers: IAnswer[], 
  questions: IQuestion[]
): IQuizResult {
  // 구현...
}
```

## strictNullChecks 준수

모든 코드는 `strictNullChecks` 옵션을 고려하여 작성합니다.

```typescript
// ✅ null 체크
function getQuestion(id: string): IQuestion | null {
  const question = QUIZ_QUESTIONS.find(q => q.id === id)
  return question ?? null
}

const question = getQuestion('q1')
if (question) {
  // question은 IQuestion 타입
  console.log(question.text)
}
```
